<!DOCTYPE html>
<html>
<head>
  <title>RED CAR BLUE CAR</title>
  <style>
    body { 
      font-family: 'Franklin Gothic Medium';
      text-align: center; 
      background-image: url("SITEBG2.png");
      background-size: 100% 150%;
      color: azure;
    }
    video, canvas { 
      display: inline-block; 
      margin: 10px auto; 
      border: 4px solid white; 
    }
    .scoreboard { 
      margin-top: 20px; 
      font-size: 1.2em; 
    }
    .scoreboard span { 
      display: inline-block; 
      margin: 0 15px; 
    }
  </style>
</head>
<body>
  <h1>ðŸŽ¯ Colour Counter Game</h1>

  <!-- Camera feed -->
  <video id="video" width="320" height="240" autoplay></video>
  
  <!-- Canvas for processing frames (hidden) -->
  <canvas id="canvas" width="320" height="240" style="display:none;"></canvas>
  
  <!-- Scoreboard -->
  <div class="scoreboard">
    <span>ðŸ”´ Red: <b id="redScore">0</b></span>
    <span>ðŸŸ¢ Green: <b id="greenScore">0</b></span>
    <span>ðŸ”µ Blue: <b id="blueScore">0</b></span>
  </div>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    let scores = { Red: 0, Green: 0, Blue: 0 };

    // Ask for camera access
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
      })
      .catch(err => {
        console.error("Camera error:", err);
        alert("Unable to access camera. Please allow permissions.");
      });

    function getMajorityColor() {
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      const frame = ctx.getImageData(0, 0, canvas.width, canvas.height);
      const data = frame.data;

      let r = 0, g = 0, b = 0, total = 0;

      for (let i = 0; i < data.length; i += 4) {
        r += data[i];
        g += data[i + 1];
        b += data[i + 2];
        total++;
      }

      r /= total; g /= total; b /= total;

      // ðŸ”µ Only increment blue regardless of majority color
      scores.Blue++;

      // Update display (Red & Green shown but never change)
      document.getElementById('redScore').textContent = scores.Red;
      document.getElementById('greenScore').textContent = scores.Green;
      document.getElementById('blueScore').textContent = scores.Blue;
    }

    // Check every 500ms
    setInterval(getMajorityColor, 500);
  </script>
</body>
</html>
